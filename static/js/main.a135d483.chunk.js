(this["webpackJsonppopulation-mesh"]=this["webpackJsonppopulation-mesh"]||[]).push([[0],{32:function(e,t,n){},33:function(e,t,n){},57:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),r=n(11),o=n.n(r),i=(n(32),n(3)),l=n(2),s=(n(33),n(6)),u=(n(54),n(5));function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return e.filter((function(e){return t<=+e.tags.population&&+e.tags.population<n}))}function j(e,t,n){var c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=h(e,t);return n>0&&(a=b(a,n)),c.length>0&&(a=x(a,c)),a}function h(e,t){var n,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=[],r=Object(u.a)(e);try{for(r.s();!(n=r.n()).done;){var o,i=n.value,l=Object(u.a)(e);try{for(l.s();!(o=l.n()).done;){var s=o.value;if(i.id<s.id){var d=O(i,s);d<t&&!p(i,s,c)&&a.push([i,s])}}}catch(j){l.e(j)}finally{l.f()}}}catch(j){r.e(j)}finally{r.f()}return a}function p(e,t,n){var c,a=e.id<t.id?e:t,r=e.id<t.id?t:e,o=Object(u.a)(n);try{for(o.s();!(c=o.n()).done;){var i=Object(l.a)(c.value,2),s=i[0],d=i[1];if(a===s&&r===d)return!0}}catch(j){o.e(j)}finally{o.f()}return!1}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(t<=0)return e;e.sort(f);var n,c=[],a=Object(u.a)(e);try{for(a.s();!(n=a.n()).done;){var r,o=n.value,i=!0,l=Object(u.a)(c);try{for(l.s();!(r=l.n()).done;){var s=r.value,d=v(o,s);if(d){var j=g([d[1],d[0]],[d[1],d[2]]);if(j<t){i=!1;break}}}}catch(h){l.e(h)}finally{l.f()}i&&c.push(o)}}catch(h){a.e(h)}finally{a.f()}return c}function f(e,t){return O(e[0],e[1])-O(t[0],t[1])}function O(e,t){var n=e.lat*Math.PI/180,c=t.lat*Math.PI/180,a=(t.lat-e.lat)*Math.PI/180,r=(t.lon-e.lon)*Math.PI/180,o=Math.sin(a/2)*Math.sin(a/2)+Math.cos(n)*Math.cos(c)*Math.sin(r/2)*Math.sin(r/2);return 6371e3*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}function g(e,t){var n=m(e[0],e[1]),c=m(t[0],t[1]),a=Math.abs(c-n);return a>180?180-(a-180):a}function m(e,t){var n=e.lat*Math.PI/180,c=t.lat*Math.PI/180,a=(t.lon-e.lon)*Math.PI/180,r=Math.cos(c)*Math.sin(a),o=Math.cos(n)*Math.sin(c)-Math.sin(n)*Math.cos(c)*Math.cos(a);return 180*Math.atan2(o,r)/Math.PI}function x(e,t){return e.filter((function(e){return"undefined"===typeof t.find((function(t){return e[0]===t[0]&&e[1]===t[1]}))}))}function v(e,t){return e[0]===t[0]?[e[1],e[0],t[1]]:e[0]===t[1]?[e[1],e[0],t[0]]:e[1]===t[0]?[e[0],e[1],t[1]]:e[1]===t[1]?[e[0],e[1],t[0]]:void 0}function y(e,t){return+t.tags.population-+e.tags.population}function S(e,t){var n=function(e,t){var n=+e.tags.population>+t.tags.population?"".concat(e.tags.name," and ").concat(t.tags.name):"".concat(t.tags.name," and ").concat(e.tags.name);return/ and .+ and /.test(n)?n.replace(/ and /,", "):n}(e,t),c=+e.tags.population,a=+t.tags.population,r=c+a,o=r.toString(),i=a/r;return{id:Math.min(e.id,t.id),lat:w(e.lat,t.lat,i),lon:w(e.lon,t.lon,i),type:"node",tags:{name:n,population:o}}}function w(e,t,n){return e+n*(t-e)}function k(e){return'<?xml version="1.0" encoding="UTF-8"?>\n<kml xmlns="http://www.opengis.net/kml/2.2">\n    <Document>\n        <Style id="tier1_places">\n            <IconStyle>\n                <color>ffffff00</color>\n                <scale>2</scale>\n                <Icon>\n                    <href>http://maps.google.com/mapfiles/kml/paddle/wht-blank.png</href>\n                </Icon>\n                <hotSpot x="32" y="1" xunits="pixels" yunits="pixels"/>\n            </IconStyle>\n        </Style>\n        <Style id="tier2_places">\n            <IconStyle>\n                <color>ffcf9a02</color>\n                <scale>1.6666</scale>\n                <Icon>\n                    <href>http://maps.google.com/mapfiles/kml/paddle/wht-blank.png</href>\n                </Icon>\n                <hotSpot x="32" y="1" xunits="pixels" yunits="pixels"/>\n            </IconStyle>\n        </Style>\n        <Style id="tier3_places">\n            <IconStyle>\n                <color>ffff7f00</color>\n                <scale>1.25</scale>\n                <Icon>\n                    <href>http://maps.google.com/mapfiles/kml/paddle/wht-blank.png</href>\n                </Icon>\n                <hotSpot x="32" y="1" xunits="pixels" yunits="pixels"/>\n            </IconStyle>\n        </Style>\n        <Style id="tier4_places">\n            <IconStyle>\n                <color>ffcc0000</color>\n                <scale>1</scale>\n                <Icon>\n                    <href>http://maps.google.com/mapfiles/kml/paddle/wht-blank.png</href>\n                </Icon>\n                <hotSpot x="32" y="1" xunits="pixels" yunits="pixels"/>\n            </IconStyle>\n        </Style>\n        <Style id="tier1_connectors">\n            <LineStyle>\n                <color>ffffff00</color>\n                <width>5</width>\n            </LineStyle>\n        </Style>\n        <Style id="tier2_connectors">\n            <LineStyle>\n                <color>ffcf9a02</color>\n                <width>4</width>\n            </LineStyle>\n        </Style>\n        <Style id="tier3_connectors">\n            <LineStyle>\n                <color>ffff7f00</color>\n                <width>3</width>\n            </LineStyle>\n        </Style>\n        <Style id="tier4_connectors">\n            <LineStyle>\n                <color>ffcc0000</color>\n                <width>2</width>\n            </LineStyle>\n        </Style>\n        '.concat(e.map((function(e){return function(e){return"\n    <Folder>\n        <name>".concat(e.label,"</name>\n        ").concat(e.points?e.points.map((function(t){return n=t,c=e.style,"\n        <Placemark>\n            <name>".concat(n.tags.name,"</name>\n            <description>Population: ").concat(n.tags.population,"</description>\n            <styleUrl>#").concat(c,"</styleUrl>\n            <Point>\n                <coordinates>").concat(n.lon,",").concat(n.lat,",0</coordinates>\n            </Point>\n        </Placemark>");var n,c})).join(""):"","\n        ").concat(e.lines?e.lines.map((function(t){return function(e,t){var n=Object(l.a)(e,2),c=n[0],a=n[1];return"\n        <Placemark>\n            <name>".concat(c.tags.name," to ").concat(a.tags.name,"</name>\n            <description>Distance: ").concat(O(c,a).toFixed(0),"m</description>\n            <styleUrl>#").concat(t,"</styleUrl>\n            <LineString>\n                <coordinates>\n                    ").concat(c.lon,",").concat(c.lat,",0\n                    ").concat(a.lon,",").concat(a.lat,",0\n                </coordinates>\n            </LineString>\n        </Placemark>")}(t,e.style)})).join(""):"","\n    </Folder>")}(e)})).join(""),"\n    </Document>\n</kml>")}function E(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Object(c.useState)((function(){var n=localStorage.getItem(e);if(n)try{return JSON.parse(n)}catch(c){}return t instanceof Function?t():t})),r=Object(l.a)(a,2),o=r[0],i=r[1];Object(c.useEffect)((function(){if(n){var t=function(t){if(t.key===e)try{i(JSON.parse(t.newValue))}catch(t){}};return window.addEventListener("storage",t),function(){return window.removeEventListener("storage",t)}}}),[e,n]);var s=Object(c.useCallback)((function(t){i(t),localStorage.setItem(e,JSON.stringify(t))}),[i,e]);return[o,s]}var P=["#00FFFF","#029ACF","#007FFF","#0000CC"];function _(e,t){return{type:"FeatureCollection",features:[].concat(Object(i.a)(e.map((function(e){return{geometry:{type:"Point",coordinates:[e.lon,e.lat]},properties:{name:e.tags.name}}}))),Object(i.a)(t.map((function(e){var t=Object(l.a)(e,2),n=t[0],c=t[1];return{geometry:{type:"LineString",coordinates:[[n.lon,n.lat],[c.lon,c.lat]]},properties:{name:"From ".concat(n.tags.name," to ").concat(c.tags.name)}}}))))}}var M=n(0);function L(e){var t=e.places,n=void 0===t?[]:t,c=e.connectors,a=void 0===c?[]:c,r=e.tier,o=_(n,[]),i=_([],a),l=function(e){return{"circle-radius":{base:5/e,stops:[[12,10/e],[22,180/e]]},"circle-color":P[e-1]}}(r),u=function(e){return{"line-width":{base:3/e,stops:[[12,5/e],[22,90/e]]},"line-color":P[e-1]}}(r);return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(s.a,{data:o,circlePaint:l}),Object(M.jsx)(s.a,{data:i,linePaint:u})]})}function N(e){var t=e.n,n=e.singular,c=e.plural,a=void 0===c?null:c;return Object(M.jsx)(M.Fragment,{children:"".concat(t," ").concat(1===t?n:a||n+"s")})}function I(e){var t=e.label,n=e.places,c=e.connectors,a=e.showNodes,r=e.setShowNodes,o=e.showVertices,i=e.setShowVertices,l=e.maxVertexLength,s=e.setMaxVertexLength;return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("h2",{children:t}),Object(M.jsxs)("label",{children:[Object(M.jsx)("input",{type:"checkbox",checked:a,onChange:function(e){return r(e.target.checked)}}),Object(M.jsx)(N,{n:n.length,singular:"Place"})]}),Object(M.jsxs)("label",{children:[Object(M.jsx)("input",{type:"checkbox",checked:o,onChange:function(e){return i(e.target.checked)}}),Object(M.jsx)(N,{n:c.length,singular:"Connection"})]}),Object(M.jsxs)("label",{children:["Max Connection Length (km)",Object(M.jsx)("input",{type:"number",min:0,value:l/1e3,onChange:function(e){return s(1e3*e.target.valueAsNumber)}})]})]})}function C(e,t){var n=e.map((function(e){return e.toFixed(3)})).join(","),c=Object.entries(t).map((function(e){var t=Object(l.a)(e,2),n=t[0],c=t[1];return!0===c?"[".concat(n,"]"):Array.isArray(c)?"[".concat(n,'~"^').concat(c.join("|"),'$"]'):"[".concat(n,'="').concat(c,'"]')})).join("");if(!c)throw new Error("Too many nodes");return function(e){var t=T.find((function(t){return t.url===e}));t||(t={url:e,result:fetch(e).then((function(e){return e.ok?e.json():429===e.status?Promise.reject("Too many requests. Please wait a minute."):Promise.reject("Error fetching data")}))},T.unshift(t),T.length=Math.min(10,T.length));return t.result}("https://overpass-api.de/api/interpreter?data=[out:json][bbox];node".concat(c,";out ").concat(1e4,";&bbox=").concat(n))}var T=[];function V(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=Object(c.useState)(null),a=Object(l.a)(n,2),r=a[0],o=a[1],i=Object(c.useState)(null),s=Object(l.a)(i,2),u=s[0],d=s[1],j=Object(c.useState)(!1),h=Object(l.a)(j,2),p=h[0],b=h[1];return Object(c.useEffect)((function(){fetch(e,t).then((function(e){return e.ok?e.headers.get("Content-Type").includes("application/json")?e.json():e.text():Promise.reject("Error fetching data")})).then((function(e){o(e),d(null)}),d).then((function(){return b(!1)})),b(!0)}),[e,t]),[r,u,p]}var F={place:["city","town","village"]};function H(e){var t=function(e,t){var n=Object(c.useState)([]),a=Object(l.a)(n,2),r=a[0],o=a[1],i=Object(c.useState)(null),s=Object(l.a)(i,2),u=s[0],d=s[1],j=Object(c.useState)(!1),h=Object(l.a)(j,2),p=h[0],b=h[1];return Object(c.useEffect)((function(){C(e,t).then((function(e){o(e.elements),d(null)}),d).then((function(){return b(!1)})),b(!0)}),[e,t]),[r,u,p]}(e.bounds,F),n=Object(l.a)(t,3),a=n[0],r=n[1],o=n[2];a.sort(R);return Object(M.jsxs)("section",{style:{backgroundColor:"white",width:"80%",position:"fixed",height:"90%",top:"5%",left:"10%",borderRadius:30,padding:20,boxSizing:"border-box",boxShadow:"-10px -10px 60px rgba(0,0,0,0.6), 15px 15px 20px rgba(0,0,0,0.6)",display:"flex",flexDirection:"column"},children:[Object(M.jsx)("h1",{children:"Population Inspector"}),o&&Object(M.jsx)("p",{children:"Loading\u2026"}),r&&Object(M.jsx)("p",{style:{color:"red"},children:r.toString()}),a.length>0&&Object(M.jsx)("div",{style:{flex:1,overflowY:"auto"},children:Object(M.jsxs)("table",{children:[Object(M.jsx)("thead",{children:Object(M.jsxs)("tr",{children:[Object(M.jsx)("th",{children:"Name"}),Object(M.jsx)("th",{children:"Type"}),Object(M.jsx)("th",{children:"Population"}),Object(M.jsx)("th",{children:"Links"}),Object(M.jsx)("th",{children:"Wikidata"}),Object(M.jsx)("th",{children:"Wikipedia"})]})}),Object(M.jsx)("tbody",{children:a.map((function(e){var t;return Object(M.jsxs)("tr",{children:[Object(M.jsx)("td",{children:e.tags.name}),Object(M.jsx)("td",{children:e.tags.place}),Object(M.jsxs)("td",{children:[Object(M.jsx)(A,{population:+e.tags.population||0}),e.tags.population||""]}),Object(M.jsxs)("td",{children:[Object(M.jsx)("a",{href:"https://www.openstreetmap.org/#map=12/".concat(e.lat,"/").concat(e.lon),target:"_blank",rel:"noreferrer",children:"Map"})," ",Object(M.jsx)("a",{href:"https://www.openstreetmap.org/edit#map=20/".concat(e.lat,"/").concat(e.lon),target:"_blank",rel:"noreferrer",children:"Edit"})," ",Object(M.jsx)("a",{href:"https://www.openstreetmap.org/node/".concat(e.id),target:"_blank",rel:"noreferrer",children:"View"})," ",Object(M.jsx)("a",{href:"https://en.wikipedia.org/wiki/".concat(e.tags.name),target:"_blank",rel:"noreferrer",children:"Wikipedia"})," ",e.tags.wikidata&&Object(M.jsx)("a",{href:"https://www.wikidata.org/wiki/".concat(e.tags.wikidata),target:"_blank",rel:"noreferrer",children:"Wikidata"})]}),Object(M.jsx)("td",{children:!e.tags.population&&e.tags.wikidata&&Object(M.jsx)(W,{id:e.tags.wikidata,claim:U.population})}),Object(M.jsx)("td",{children:!e.tags.population&&Object(M.jsx)(D,{name:(null===(t=e.tags.wikipedia)||void 0===t?void 0:t.replace(/[a-z]+:/,""))||e.tags.name})})]},e.id)}))})]})})]})}function R(e,t){var n={city:{city:0,town:-1,village:-1},town:{city:1,town:0,village:-1},village:{city:1,town:1,village:0}}[e.tags.place][t.tags.place];return 0===n?e.tags.name.localeCompare(t.tags.name):n}function A(e){var t,n,c=e.population;return c>1e5?(t=12,n=P[0]):c>5e4?(t=6,n=P[1]):c>1e4?(t=4,n=P[2]):c>5e3&&(t=3,n=P[3]),Object(M.jsx)("svg",{width:24,height:24,viewBox:"-12 -12 24 24",style:{verticalAlign:"text-top"},children:Object(M.jsx)("circle",{r:t,fill:n})})}function D(e){var t=e.name,n=V("https://en.wikipedia.org/api/rest_v1/page/html/".concat(t)),c=Object(l.a)(n,3),a=c[0],r=c[1],o=c[2];if(r)return Object(M.jsx)("span",{style:{color:"red"},children:r.message});if(o)return Object(M.jsx)("span",{children:"Loading\u2026"});if(a){var i=(new DOMParser).parseFromString(a,"text/html").querySelector("[data-mw*=population_ref]");if(!i)return null;try{var s,u,d=JSON.parse(i.dataset.mw).parts[0].template.params,j=function(e){var t=/\[\[([^[\]]+)\]\]/.exec(e);if(t)return t[1].split("|")[0];return e.replace(/<.*>/,"").replace(/\[\[.*\]\]/,"").replace(/^\(|\)$/g,"")}(null===(s=d.population_ref)||void 0===s?void 0:s.wt);return Object(M.jsxs)("p",{children:[d.population.wt," ",(null===(u=d.population_ref)||void 0===u?void 0:u.wt.includes("Parish"))&&Object(M.jsx)("span",{style:{color:"#FF0000",fontSize:"0.8em"},children:"Parish"})," ",Object(M.jsx)("span",{style:{color:"#666",fontSize:"0.8em"},children:j})]})}catch(h){return console.error(h),Object(M.jsx)("p",{style:{color:"red"},children:"Error parsing"})}}return Object(M.jsx)("p",{style:{color:"red"},children:"Shouldn't be here"})}var U={pointInTime:"P585",population:"P1082"};function W(e){var t=e.id,n=e.claim,c=V("https://www.wikidata.org/wiki/Special:EntityData/".concat(t,".json")),a=Object(l.a)(c,3),r=a[0],o=a[1],i=a[2];if(o)return Object(M.jsx)("span",{style:{color:"red"},children:o.message});if(i)return Object(M.jsx)("span",{children:"Loading\u2026"});if(r)try{var s=r.entities[t].claims[n];if(s){s.sort(J);var u=+s[0].mainsnak.datavalue.value.amount;return Object(M.jsx)("span",{children:u})}return null}catch(d){return Object(M.jsx)("span",{style:{color:"red"},children:d.message})}return Object(M.jsx)("span",{style:{color:"red"},children:"Shouldn't be here!?"})}function J(e,t){var n,c,a=null===(n=e.qualifiers[U.pointInTime])||void 0===n?void 0:n[0].datavalue.value.time,r=null===(c=t.qualifiers[U.pointInTime])||void 0===c?void 0:c[0].datavalue.value.time;return-String(a).localeCompare(r)}var z=n(18),q=n.n(z),B=n(27);function G(){return(G=Object(B.a)(q.a.mark((function e(t){var c,a;return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(3).then(n.t.bind(null,58,3));case 2:return c=e.sent.default,a=c.filter((function(e){return Y(e,t)})),e.abrupt("return",a.map((function(e){return{id:e.id,type:"node",lat:e.lat,lon:e.lon,tags:{name:e.name,population:e.pop.toString()}}})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e,t){return e.lon>=t[0]&&e.lon<t[2]&&e.lat>=t[1]&&e.lat<t[3]}var X=Object(s.d)({accessToken:"pk.eyJ1IjoiaWptYWNkIiwiYSI6ImNqZ2J6dnNvYjM5Y3QzMnFkYWNybzM2bnkifQ.OE6IZdjeV6XK-NGACNu60g"}),Z=function(e){var t=localStorage.getItem(e);if(t)try{return JSON.parse(t)}catch(n){}return}("POPMESH_CENTRE_ZOOM"),K=Z?Z.slice(0,2):[-3.667,56.66],Q=Z?Z.slice(2):[7],$=[{id:"osm",label:"OpenStreetMap",coverage:"World"},{id:"nomis",label:"Nomis",coverage:"England and Wales"}];var ee=function(){var e=Object(c.useState)([]),t=Object(l.a)(e,2),n=t[0],a=t[1],r=Object(c.useRef)(null),o=E("POPMESH_LOAD_ON_SCROLL",!1,!1),h=Object(l.a)(o,2),p=h[0],b=h[1],f=Object(c.useState)(!1),g=Object(l.a)(f,2),m=g[0],x=g[1],v=Object(c.useState)(null),w=Object(l.a)(v,2),P=w[0],_=w[1],T=Object(c.useState)(!1),V=Object(l.a)(T,2),F=V[0],R=V[1],A=E("POPMESH_DATA_SOURCE",$[0].id,!1),D=Object(l.a)(A,2),U=D[0],W=D[1],J=Object(c.useState)(!1),z=Object(l.a)(J,2),q=z[0],B=z[1],Y=E("POPMESH_NODES_T1",!0,!1),Z=Object(l.a)(Y,2),ee=Z[0],te=Z[1],ne=E("POPMESH_VERTICES_T1",!0,!1),ce=Object(l.a)(ne,2),ae=ce[0],re=ce[1],oe=E("POPMESH_VERTEX_LENGTH_T1",105e3,!1),ie=Object(l.a)(oe,2),le=ie[0],se=ie[1],ue=E("POPMESH_NODES_T2",!0,!1),de=Object(l.a)(ue,2),je=de[0],he=de[1],pe=E("POPMESH_VERTICES_T2",!0,!1),be=Object(l.a)(pe,2),fe=be[0],Oe=be[1],ge=E("POPMESH_VERTEX_LENGTH_T2",1e5,!1),me=Object(l.a)(ge,2),xe=me[0],ve=me[1],ye=E("POPMESH_NODES_T3",!0,!1),Se=Object(l.a)(ye,2),we=Se[0],ke=Se[1],Ee=E("POPMESH_VERTICES_T3",!0,!1),Pe=Object(l.a)(Ee,2),_e=Pe[0],Me=Pe[1],Le=E("POPMESH_VERTEX_LENGTH_T3",95e3,!1),Ne=Object(l.a)(Le,2),Ie=Ne[0],Ce=Ne[1],Te=E("POPMESH_NODES_T4",!0,!1),Ve=Object(l.a)(Te,2),Fe=Ve[0],He=Ve[1],Re=E("POPMESH_VERTICES_T4",!1,!1),Ae=Object(l.a)(Re,2),De=Ae[0],Ue=Ae[1],We=E("POPMESH_VERTEX_LENGTH_T4",9e4,!1),Je=Object(l.a)(We,2),ze=Je[0],qe=Je[1],Be=E("POPMESH_NARROW_ANGLE",15,!1),Ge=Object(l.a)(Be,2),Ye=Ge[0],Xe=Ge[1],Ze=E("POPMESH_CONURBATION_COLLAPSE",!1,!1),Ke=Object(l.a)(Ze,2),Qe=Ke[0],$e=Ke[1],et=Object(c.useCallback)((function(){if(r.current){var e=r.current.getBounds().toArray().flat();"osm"===U?(C(e,{population:!0,place:["city","town","village"]}).then((function(e){a(e.elements),_(null)}),_).then((function(){return x(!1)})),x(!0)):"nomis"===U&&function(e){return G.apply(this,arguments)}(e).then(a)}}),[U]);Object(c.useEffect)(et,[et]);var tt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=Object(c.useRef)(!0);return Object(c.useCallback)((function(){n.current&&(e.apply(void 0,arguments),n.current=!1,setTimeout((function(){return n.current=!0}),t))}),[e,t])}(et,5e3);Object(c.useEffect)((function(){function e(e){"p"===e.key&&e.altKey&&B((function(e){return!e}))}return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}));var nt=n.length>0,ct=Object(c.useMemo)((function(){return Qe?function(e,t){e.sort(y);var n,c=[],a=Object(u.a)(e);try{e:for(a.s();!(n=a.n()).done;){for(var r=n.value,o=0;o<c.length;o++){var i=c[o];if(O(r,i)<t){c[o]=S(r,i);continue e}}c.push(r)}}catch(l){a.e(l)}finally{a.f()}return c}(n,3500):n}),[Qe,n]);Object(c.useEffect)((function(){function e(){!p&&nt||tt();var e=r.current.getCenter().toArray(),t=r.current.getZoom();localStorage.setItem("POPMESH_CENTRE_ZOOM",JSON.stringify([].concat(Object(i.a)(e),[t])))}if(r.current)return r.current.on("moveend",e),function(){r.current.off("moveend",e)}}),[tt,p,nt,F]);var at=d(ct,1e5),rt=ae?j(at,le,Ye):[],ot=d(ct,5e4,1e5),it=[].concat(Object(i.a)(at),Object(i.a)(ot)),lt=fe?j(it,xe,Ye,rt):[],st=d(ct,1e4,5e4),ut=[].concat(Object(i.a)(at),Object(i.a)(ot),Object(i.a)(st)),dt=[].concat(Object(i.a)(rt),Object(i.a)(lt)),jt=_e?j(ut,Ie,Ye,dt):[],ht=d(ct,5e3,1e4),pt=[].concat(Object(i.a)(at),Object(i.a)(ot),Object(i.a)(st),Object(i.a)(ht)),bt=[].concat(Object(i.a)(rt),Object(i.a)(lt),Object(i.a)(jt)),ft=De?j(pt,ze,Ye,bt):[];return Object(M.jsxs)("div",{className:"App",children:[Object(M.jsxs)("div",{className:"Panel",children:[Object(M.jsxs)("label",{children:[Object(M.jsx)("span",{style:{fontWeight:"bold"},children:"Data Source"}),Object(M.jsx)("select",{value:U,onChange:function(e){return W(e.target.value)},children:$.map((function(e){return Object(M.jsxs)("option",{value:e.id,children:[e.label," (",e.coverage,")"]},e.id)}))})]}),P?Object(M.jsx)("p",{style:{color:"red"},children:P.toString()}):m?Object(M.jsx)("p",{children:"Loading\u2026"}):Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("p",{children:Object(M.jsx)(N,{n:n.length,singular:"Total Place"})}),n.length!==ct.length&&Object(M.jsx)("p",{children:Object(M.jsx)(N,{n:ct.length,singular:"Conurbation"})})]}),Object(M.jsxs)("label",{children:[Object(M.jsx)("input",{type:"checkbox",checked:p,onChange:function(e){return b(e.target.checked)}}),"Load on pan/zoom"]}),Object(M.jsx)("button",{onClick:et,children:"Load now"}),Object(M.jsx)(I,{label:"100k+",places:at,connectors:rt,showNodes:ee,setShowNodes:te,showVertices:ae,setShowVertices:re,maxVertexLength:le,setMaxVertexLength:se}),Object(M.jsx)(I,{label:"50k - 100k",places:ot,connectors:lt,showNodes:je,setShowNodes:he,showVertices:fe,setShowVertices:Oe,maxVertexLength:xe,setMaxVertexLength:ve}),Object(M.jsx)(I,{label:"10k - 50k",places:st,connectors:jt,showNodes:we,setShowNodes:ke,showVertices:_e,setShowVertices:Me,maxVertexLength:Ie,setMaxVertexLength:Ce}),Object(M.jsx)(I,{label:"5k - 10k",places:ht,connectors:ft,showNodes:Fe,setShowNodes:He,showVertices:De,setShowVertices:Ue,maxVertexLength:ze,setMaxVertexLength:qe}),Object(M.jsx)("h2",{children:"Options"}),Object(M.jsxs)("label",{children:["Narrow Angle Limit "," ",Object(M.jsx)("input",{type:"number",min:0,max:180,value:Ye,onChange:function(e){return Xe(e.target.valueAsNumber)}})," ","(degrees)"]}),Object(M.jsxs)("label",{children:["Collapse Conurbations"," ",Object(M.jsx)("input",{type:"checkbox",checked:Qe,onChange:function(e){return $e(e.target.checked)}})]}),Object(M.jsx)("h2",{children:"Download"}),Object(M.jsx)("button",{onClick:function(){var e=[];ee&&e.push({label:"100k+",points:at,style:"tier1_places"}),je&&e.push({label:"50k - 100k",points:ot,style:"tier2_places"}),we&&e.push({label:"10k - 50k",points:st,style:"tier3_places"}),Fe&&e.push({label:"5k - 10k",points:ht,style:"tier4_places"}),ae&&e.push({label:"Connections 100k+",lines:rt,style:"tier1_connectors"}),fe&&e.push({label:"Connections 50k - 100k",lines:lt,style:"tier2_connectors"}),_e&&e.push({label:"Connections 10k - 50k",lines:jt,style:"tier3_connectors"}),De&&e.push({label:"Connections 5k - 10k",lines:ft,style:"tier4_connectors"}),function(e,t){var n=new Blob([t]),c=window.URL.createObjectURL(n),a=document.createElement("a");a.href=c,a.download=e,document.body.append(a),a.click(),setTimeout((function(){document.body.removeChild(a),window.URL.revokeObjectURL(c)}))}("places.kml",k(e))},children:"kml"})]}),Object(M.jsxs)(X,{style:"mapbox://styles/mapbox/streets-v9",containerStyle:{height:"100vh",width:"100vw"},onSourceData:function(e){r.current||R(!0),r.current=e},center:K,zoom:Q,children:[Object(M.jsx)(L,{places:ee?at:[],connectors:rt,tier:1}),Object(M.jsx)(L,{places:je?ot:[],connectors:lt,tier:2}),Object(M.jsx)(L,{places:we?st:[],connectors:jt,tier:3}),Object(M.jsx)(L,{places:Fe?ht:[],connectors:ft,tier:4}),Object(M.jsx)(s.c,{}),Object(M.jsx)(s.b,{})]}),q&&Object(M.jsx)(H,{bounds:r.current.getBounds().toArray().flat()})]})};o.a.render(Object(M.jsx)(a.a.StrictMode,{children:Object(M.jsx)(ee,{})}),document.getElementById("root"))}},[[57,1,2]]]);
//# sourceMappingURL=main.a135d483.chunk.js.map